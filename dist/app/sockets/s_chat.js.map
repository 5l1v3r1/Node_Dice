{"version":3,"sources":["../../../src/app/sockets/s_chat.js"],"names":["module","exports","io","on","socket","session","handshake","GetChats","err","chats","console","error","emit","chat","chatUser","username","chatTime","Date","AddChat","broadcast","chatMsg"],"mappings":";;AAAC;;;;;;AACDA,OAAOC,OAAP,GAAkB,UAACC,EAAD,EAAQ;;AAEtBA,OAAGC,EAAH,CAAM,YAAN,EAAoB,UAAUC,MAAV,EAAkB;AAClC,YAAIC,UAAUD,OAAOE,SAAP,CAAiBD,OAA/B;;AAEAD,eAAOD,EAAP,CAAU,UAAV,EAAsB,YAAY;AAC9B,iCAAWI,QAAX,CAAoB,UAAUC,GAAV,EAAeC,KAAf,EAAsB;AACtC,oBAAID,GAAJ,EAAS,OAAOE,QAAQC,KAAR,CAAc,oBAAoBH,GAAlC,CAAP;AACTJ,uBAAOQ,IAAP,CAAY,UAAZ,EAAwBH,KAAxB;AACH,aAHD;AAIH,SALD;;AAOAL,eAAOD,EAAP,CAAU,UAAV,EAAsB,UAAUU,IAAV,EAAgB;AAClCA,iBAAKC,QAAL,GAAgBT,QAAQU,QAAxB;AACAF,iBAAKG,QAAL,GAAgB,IAAIC,IAAJ,EAAhB;AACA,iCAAWC,OAAX,CAAmBL,IAAnB,EAAyB,UAAUL,GAAV,EAAe;AACpC,oBAAIA,GAAJ,EAAS,OAAOE,QAAQC,KAAR,CAAc,oBAAoBH,GAAlC,CAAP;AACZ,aAFD;AAGAJ,mBAAOe,SAAP,CAAiBP,IAAjB,CAAsB,UAAtB,EAAkC;AAC9BE,0BAAUD,KAAKC,QADe;AAE9BE,0BAAUH,KAAKG,QAFe;AAG9BI,yBAASP,KAAKO;AAHgB,aAAlC;AAKH,SAXD;AAYH,KAtBD;AAwBH,CA1BD","file":"s_chat.js","sourcesContent":["ï»¿import chatHelper from '../helper/chatHelper';\r\nmodule.exports =  (io) => {\r\n    \r\n    io.on('connection', function (socket) {\r\n        var session = socket.handshake.session;\r\n        \r\n        socket.on('getChats', function () {\r\n            chatHelper.GetChats(function (err, chats) {\r\n                if (err) return console.error('getChats error:' + err);\r\n                socket.emit('getChats', chats);\r\n            });\r\n        });\r\n\r\n        socket.on('sendChat', function (chat) {\r\n            chat.chatUser = session.username;\r\n            chat.chatTime = new Date();\r\n            chatHelper.AddChat(chat, function (err) {\r\n                if (err) return console.error('sendChat error:' + err);\r\n            });\r\n            socket.broadcast.emit('recvChat', {\r\n                chatUser: chat.chatUser, \r\n                chatTime: chat.chatTime, \r\n                chatMsg: chat.chatMsg\r\n            })\r\n        });\r\n    });\r\n\r\n}"]}
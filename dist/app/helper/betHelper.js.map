{"version":3,"sources":["../../../src/app/helper/betHelper.js"],"names":["mongoose","db","betSchema","Schema","userid","String","clientSalt","serverSalt","nonce","Number","amount","selNum","unit","betTime","type","Date","expires","index","rollNum","betId","autoIndex","mongodb","statics","GetBetsByUser","callback","query","betModel","find","limit","sort","exec","GetAllBets","model","module","exports"],"mappings":"AAAC;;;;;;AAMD;;AAEA;;;;AACA;;;;;;AAEA,IAAMA,WAAW,mBAAOA,QAAxB;AACA,IAAMC,KAAK,mBAAOA,EAAlB;AACA;AACA,IAAMC,YAAY,IAAIF,SAASG,MAAb,CAAoB;AAClCC,YAAQC,MAD0B;AAElCC,gBAAYD,MAFsB;AAGlCE,gBAAYF,MAHsB;AAIlCG,WAAOC,MAJ2B;AAKlCC,YAAQD,MAL0B;AAMlCE,YAAQF,MAN0B;AAOlCG,UAAMP,MAP4B;AAQlCQ,aAAS,EAAEC,MAAMC,IAAR,EAAcC,SAAS,KAAK,EAAL,GAAU,EAAV,GAAe,EAAtC,EAA0CC,OAAO,IAAjD,EARyB;AASlCC,aAAST,MATyB;AAUlCU,WAAOd;AAV2B,CAApB,EAWf,EAAEe,WAAW,iBAAOC,OAAP,CAAeD,SAA5B,EAXe,CAAlB;AAYA;AACAlB,UAAUoB,OAAV,GAAoB;AAChBC,mBAAe,uBAAUnB,MAAV,EAAkBoB,QAAlB,EAA4B;AACvC,YAAIC,QAAQC,SAASC,IAAT,CAAc,EAAEvB,QAAQA,MAAV,EAAd,EAAkC,0CAAlC,EAA8E,EAAEwB,OAAO,GAAT,EAA9E,CAAZ;AACAH,cAAMI,IAAN,CAAW,EAAEhB,SAAS,CAAC,CAAZ,EAAX,EAA4BiB,IAA5B,CAAiCN,QAAjC;AACH,KAJe;AAKhBO,gBAAY,oBAAUP,QAAV,EAAoB;AAC5B,YAAIC,QAAQC,SAASC,IAAT,CAAc,EAAd,EAAkB,0CAAlB,EAA8D,EAAEC,OAAO,GAAT,EAA9D,CAAZ;AACAH,cAAMI,IAAN,CAAW,EAAEhB,SAAS,CAAC,CAAZ,EAAX,EAA4BiB,IAA5B,CAAiCN,QAAjC;AACH;AARe,CAApB;;AAWA,IAAME,WAAW1B,SAASgC,KAAT,CAAe,KAAf,EAAsB9B,SAAtB,CAAjB;;AAEA+B,OAAOC,OAAP,GAAiBR,QAAjB","file":"betHelper.js","sourcesContent":["ï»¿/**\r\n * Copyright 2014 Node Dice\r\n *\r\n * Created by Neo on 2015/02/24.\r\n */\r\n\r\n'use strict';\r\n\r\nimport dbhelp from './dbHelper';\r\nimport config from '../../config';\r\n\r\nconst mongoose = dbhelp.mongoose;\r\nconst db = dbhelp.db;\r\n/*bet schema*/\r\nconst betSchema = new mongoose.Schema({\r\n    userid: String,\r\n    clientSalt: String,\r\n    serverSalt: String,\r\n    nonce: Number,\r\n    amount: Number,\r\n    selNum: Number,\r\n    unit: String,\r\n    betTime: { type: Date, expires: 60 * 60 * 24 * 30, index: true },\r\n    rollNum: Number,\r\n    betId: String\r\n}, { autoIndex: config.mongodb.autoIndex });\r\n//Static methods\r\nbetSchema.statics = {\r\n    GetBetsByUser: function (userid, callback) {\r\n        var query = betModel.find({ userid: userid }, 'rollNum nonce betTime selNum amount unit', { limit: 100 });\r\n        query.sort({ betTime: -1 }).exec(callback);\r\n    },\r\n    GetAllBets: function (callback) {\r\n        var query = betModel.find({}, 'rollNum nonce betTime selNum amount unit', { limit: 100 });\r\n        query.sort({ betTime: -1 }).exec(callback);\r\n    }\r\n};\r\n\r\nconst betModel = mongoose.model('Bet', betSchema);\r\n\r\nmodule.exports = betModel;"]}
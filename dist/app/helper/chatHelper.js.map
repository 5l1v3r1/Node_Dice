{"version":3,"sources":["../../../src/app/helper/chatHelper.js"],"names":["dbhelp","require","db","mongoose","chatSchema","Schema","chatUser","String","chatTime","type","Date","expires","chatMsg","chatModel","model","module","exports","Chat","GetChats","callback","find","limit","sort","exec","AddChat","chat","c","save"],"mappings":"AAAC;;AAED,IAAIA,SAASC,QAAQ,YAAR,CAAb;AAAA,IACIC,KAAKF,OAAOE,EADhB;AAAA,IAEIC,WAAWH,OAAOG,QAFtB;;AAIA;AACA,IAAIC,aAAa,IAAID,SAASE,MAAb,CAAoB;AACjCC,cAAUC,MADuB;AAEjCC,cAAU,EAAEC,MAAMC,IAAR,EAAcC,SAAS,KAAK,EAAL,GAAU,EAAV,GAAe,CAAtC,EAFuB,EAEmB;AACpDC,aAASL;AAHwB,CAApB,CAAjB;;AAMA,IAAIM,YAAYV,SAASW,KAAT,CAAe,MAAf,EAAuBV,UAAvB,CAAhB;;AAEAW,OAAOC,OAAP,GAAiB;AACbC,UAAMJ,SADO;AAEbK,cAAU,kBAAUC,QAAV,EAAoB;AAC1BN,kBAAUO,IAAV,CAAe,EAAf,EAAkB,2BAAlB,EAA+C,EAACC,OAAO,GAAR,EAA/C,EAA6DC,IAA7D,CAAkE,EAACd,UAAU,CAAC,CAAZ,EAAlE,EAAkFe,IAAlF,CAAuFJ,QAAvF;AACH,KAJY;AAKbK,aAAS,iBAAUC,IAAV,EAAgBN,QAAhB,EAA0B;AAC/B,YAAIO,IAAI,IAAIb,SAAJ,CAAc;AAClBP,sBAAUmB,KAAKnB,QADG;AAElBE,sBAAUiB,KAAKjB,QAFG;AAGlBI,qBAASa,KAAKb;AAHI,SAAd,CAAR;;AAMAc,UAAEC,IAAF,CAAOR,QAAP;AACH;AAbY,CAAjB","file":"chatHelper.js","sourcesContent":["ï»¿'use strict';\r\n\r\nvar dbhelp = require(\"./dbHelper\"),\r\n    db = dbhelp.db,\r\n    mongoose = dbhelp.mongoose;\r\n\r\n/*chat schema*/\r\nvar chatSchema = new mongoose.Schema({\r\n    chatUser: String,\r\n    chatTime: { type: Date, expires: 60 * 60 * 24 * 7 },//msg expired in a week\r\n    chatMsg: String\r\n});\r\n\r\nvar chatModel = mongoose.model('Chat', chatSchema);\r\n\r\nmodule.exports = {\r\n    Chat: chatModel,\r\n    GetChats: function (callback) { \r\n        chatModel.find({},'chatUser chatTime chatMsg', {limit: 100}).sort({chatTime: -1}).exec(callback);\r\n    },\r\n    AddChat: function (chat, callback) {\r\n        var c = new chatModel({\r\n            chatUser: chat.chatUser,\r\n            chatTime: chat.chatTime,\r\n            chatMsg: chat.chatMsg\r\n        });\r\n\r\n        c.save(callback);\r\n    }\r\n}"]}
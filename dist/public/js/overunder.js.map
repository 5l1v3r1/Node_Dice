{"version":3,"sources":["../../../src/public/js/overunder.js"],"names":["ouVM","$","extend","baseVM","autoBetVM","highRoll","ko","observable","steps","amountdesc","payout","min","rule","under","gameId","highRollers","selectedNumber","inc","dec","clickBet","d","baseAmount","betAmount","submitBet","cancelBet","numberofRolls","balance","showNotification","betted","rollUnder","rollOver","socket","emit","w","sn","coinName","computed","toFixed","isPayoutValid","profitOnWin","amount","parseFloat","rateLimit","method","timeout","buttonEnable","bindingHandlers","stopBinding","init","controlsDescendantBindings","applyBindings","_overunder","overunder","getBetHistory","registerOverUnderEvents","WebSocket","io","connect","transports","prototype","rollResult","allBets","getMyBets","getAllBets","on","result","code","self","roll","userid","userGuid","showResult","addToBetHistory","myBetsArray","allBetsArray","highRollArray","each","i","win","selNum","rollNum","stop","stopWin","incWin","stopLoss","incLoss","betsArray","reverse","bet","dice","gt","betTime","unit","length","pop","unshift","convertBetResult","push","moment","format","pf"],"mappings":"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","file":"overunder.js","sourcesContent":["ï»¿/**\r\n * Copyright 2014 Node Dice\r\n *\r\n * Created by Neo on 2014/11/27.\r\n */\r\n/*Knockoujs view model*/\r\nvar ouVM = $.extend({}, baseVM, autoBetVM, {\r\n    //properties\r\n    highRoll: ko.observable(0.0001),\r\n    steps: ko.observable(100),\r\n    amountdesc: ko.observable(''),\r\n    payout: ko.observable(2).extend({ min: 2 }),\r\n    rule: ko.observable('Please refer to verification page to understand how encryption works.'),\r\n    under: ko.observable(-1),\r\n    gameId: ko.observable(5),\r\n    highRollers: ko.observable(1),\r\n    selectedNumber: ko.observable(0),\r\n    //functions\r\n    inc: function () { ouVM.payout(ouVM.payout() + 0.5); },\r\n    dec: function () { ouVM.payout() >= 2.5 ? ouVM.payout(ouVM.payout() - 0.5) : 2; },\r\n    clickBet: function (d) {\r\n        this.baseAmount(this.betAmount());\r\n        this.submitBet(d);\r\n    },\r\n    cancelBet: function () {\r\n        ouVM.numberofRolls(1);\r\n    },\r\n    submitBet: function (d) {\r\n        if (ouVM.balance() < ouVM.betAmount()) {\r\n            showNotification('', 'Balance not enough.', 'danger');\r\n            return;\r\n        }\r\n        this.betted(true);\r\n        ouVM.selectedNumber(d == 0 ? ouVM.rollUnder() : ouVM.rollOver());\r\n        socket.emit('roll', { w: this.betAmount(), sn: this.selectedNumber(), coinName: this.coinName() });\r\n    } \r\n});\r\n//computed methods\r\nouVM.rollUnder = ko.computed(function () {\r\n    return (100 / ouVM.payout() * 0.99).toFixed(2);\r\n});\r\nouVM.rollOver = ko.computed(function () {\r\n    return (100 - ouVM.rollUnder()).toFixed(2);\r\n});\r\nouVM.isPayoutValid = ko.computed(function () {\r\n    return ouVM.payout() >= 2;\r\n});\r\nouVM.profitOnWin = ko.computed(function () {\r\n    var amount = parseFloat((ouVM.betAmount() * ouVM.payout()));\r\n    return amount.toFixed(10);\r\n}).extend({ rateLimit: { method: \"notifyWhenChangesStop\", timeout: 400 } });\r\n\r\nouVM.buttonEnable = ko.computed(function () {\r\n    return !ouVM.betted();\r\n});\r\n/*Knockoujs view model*/\r\n\r\n/* Page functions */\r\n$(function () {\r\n    //Be able to bind nested view model in one page.\r\n    ko.bindingHandlers.stopBinding = {\r\n        init: function () {\r\n            return { controlsDescendantBindings: true };\r\n        }\r\n    };\r\n\r\n    ko.applyBindings(ouVM);\r\n    \r\n    var _overunder = new overunder(socket);\r\n    _overunder.getBetHistory();\r\n    _overunder.registerOverUnderEvents();\r\n\r\n});\r\n\r\nvar overunder = function (socket) {\r\n    this.socket = socket;\r\n    \r\n    if (!this.socket) {\r\n        if (typeof (WebSocket) != \"function\") {\r\n            this.socket = io();\r\n        }\r\n        else {\r\n            /* Use websocket only */\r\n            this.socket = io.connect({ transports: ['websocket'] });\r\n        }\r\n    }\r\n}\r\n\r\noverunder.prototype.registerOverUnderEvents = function () {\r\n    this.rollResult();\r\n    this.allBets();\r\n    this.getMyBets();\r\n    this.getAllBets();\r\n}\r\n//receive single bet result if anything goes wrong\r\noverunder.prototype.rollResult = function () {\r\n    this.socket.on('rollResult', function (result) {\r\n        switch (result.code) {\r\n            case -1: showNotification('Fund', 'Fund not enough', 'danger');\r\n                break;\r\n            case -2 : showNotification('Wager', 'Wager invalid', 'danger');\r\n                break;\r\n            case -3: showNotification('Wager', 'Wager has to be a valid number', 'danger');\r\n                break;\r\n        }\r\n        ouVM.betted(false);\r\n    });\r\n}\r\n//receive bets after loading\r\noverunder.prototype.allBets = function () {\r\n    var self = this;\r\n    this.socket.on('allBets', function (roll) {\r\n            if (roll.userid == ouVM.userGuid()) {\r\n                self.showResult(roll);\r\n                self.addToBetHistory(myBetsArray, roll);\r\n            }\r\n        self.addToBetHistory(allBetsArray, roll);\r\n            if (roll.amount >= ouVM.highRollers())\r\n                self.addToBetHistory(highRollArray, roll);\r\n    });\r\n\r\n}\r\n//retrieve my bet history from server when loading\r\noverunder.prototype.getMyBets = function () {\r\n    var self = this;\r\n    this.socket.on('getMyBets', function (result) {\r\n            $(result).each(function (i) {\r\n                self.addToBetHistory(myBetsArray, result[i], 1);\r\n            });\r\n        })\r\n}\r\n//retrieve all bet history from server when loading\r\noverunder.prototype.getAllBets = function () {\r\n    var self = this;\r\n    this.socket.on('getAllBets', function (result) {\r\n        $(result).each(function (i) {\r\n            self.addToBetHistory(allBetsArray, this, 1);\r\n            if (result[i].amount >= ouVM.highRollers())\r\n                self.addToBetHistory(highRollArray, result[i], 1);\r\n        });\r\n    })\r\n}\r\n//show bet result in the list\r\noverunder.prototype.showResult = function(result) {\r\n    var win = true;\r\n    if ((result.selNum * 1 <= 49.5 && result.rollNum * 1 <= result.selNum * 1) \r\n     || (result.selNum * 1 >= 50.5 && result.rollNum * 1 >= result.selNum * 1)) {\r\n        if (ouVM.numberofRolls() == 1) //Don't show notification when auto betting\r\n            showNotification('', 'Dice:' + result.rollNum + '. You won', 'success');\r\n        ouVM.balance((ouVM.balance() * 1 + result.amount * (ouVM.payout() - 1)).toFixed(10));\r\n    }\r\n    else {\r\n        if (ouVM.numberofRolls() == 1) //Don't show notification when auto betting\r\n            showNotification('', 'Dice:' + result.rollNum + '. You lost', 'danger');\r\n        ouVM.balance((ouVM.balance() - result.amount).toFixed(10));\r\n        win = false;\r\n    }\r\n    //process auto betting\r\n    if (ouVM.numberofRolls() > 1) {\r\n        var stop = false;\r\n        if (win) {\r\n            if (ouVM.stopWin() * 1 > 0 && ouVM.betAmount() >= ouVM.stopWin()) { stop = true; }\r\n            else if (ouVM.incWin() == 0) {\r\n                ouVM.betAmount((ouVM.baseAmount() * 1).toFixed(10));\r\n            }\r\n            else {\r\n                ouVM.betAmount((ouVM.betAmount() * (1 + ouVM.incWin() / 100)).toFixed(10));\r\n            }\r\n        }\r\n        else {\r\n            if (ouVM.stopLoss() * 1 > 0 && ouVM.betAmount() >= ouVM.stopLoss()) { stop = true; }\r\n            else if (ouVM.incLoss() == 0) {\r\n                ouVM.betAmount((ouVM.baseAmount() * 1).toFixed(10));\r\n            }\r\n            else {\r\n                ouVM.betAmount((ouVM.betAmount() * (1 + ouVM.incLoss() / 100)).toFixed(10));\r\n            }\r\n        }\r\n        if (!stop) {\r\n            ouVM.submitBet(ouVM.selectedNumber() <= 49.5 ? 0:1);\r\n            ouVM.numberofRolls(ouVM.numberofRolls() - 1);\r\n        }\r\n    }\r\n    else\r\n        ouVM.betted(false);\r\n};\r\n\r\noverunder.prototype.addToBetHistory = function (betsArray, result, reverse) {\r\n    var bet = {\r\n        dice: result.rollNum,\r\n        w: result.amount,\r\n        gt: result.betTime,\r\n        sn: result.selNum,\r\n        unit: result.unit\r\n    };\r\n    if (betsArray().length > 100)\r\n        betsArray().pop();\r\n    if (!reverse)\r\n        betsArray.unshift(this.convertBetResult(bet));\r\n    else\r\n        betsArray.push(this.convertBetResult(bet));\r\n}\r\noverunder.prototype.getBetHistory = function() {\r\n    \r\n    this.socket.emit('getMyBets', '');\r\n    this.socket.emit('getAllBets', '');\r\n   \r\n}\r\noverunder.prototype.convertBetResult= function(bet) {\r\n    bet.gt = moment(bet.gt).format('YYYY-MM-DD HH:mm:ss');\r\n    bet.dice = parseFloat(bet.dice);\r\n    bet.payout = (bet.sn <= 49.5? 100 * 0.99 / bet.sn: 100 * 0.99 / (100 - bet.sn)).toFixed(1);\r\n    if ((bet.sn <= 49.5 && bet.dice <= bet.sn) || (bet.sn >= 50.5 && bet.dice >= bet.sn)) {\r\n        bet.pf = '<span class=\"text-primary\"><strong>' + (bet.w * (bet.payout - 1)).toFixed(10) + ' ' + bet.unit + '</strong></span>';\r\n    }\r\n    else {\r\n        bet.pf = '<span class=\"text-danger\"><strong>' + (bet.w * -1).toFixed(10) + ' ' + bet.unit + '</strong></span>';\r\n    }\r\n    bet.sn = bet.sn <= 49.5 ? '<=' + bet.sn : '>=' + bet.sn;\r\n    bet.w = (bet.w * 1).toFixed(10) + ' ' + bet.unit;\r\n    \r\n    return bet;\r\n}\r\n\r\n"]}